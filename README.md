# ryu-i-so

電車時間テーブル
create table train_schedule ( TrainTime time, LineKind int, LineDestination int, TrainKind int , UpOrDown int );

INSERT INTO train_schedule (TrainTime,LineKind,LineDestination,TrainKind,UpOrDown) VALUES ("5:28",1,2,0,0),("5:46",1,2,0,0),("6:06",1,2,0,0),("6:20",2,2,0,0),("6:24",1,1,0,0),("6:31",1,2,0,0),("6:42",3,2,0,0),("6:51",2,2,0,0),("7:06",2,2,0,0),("7:21",2,2,0,0),("7:36",2,2,0,0),("7:45",1,1,0,0),("7:51",2,2,0,0),("7:56",1,1,0,0),("8:07",2,2,0,0),("8:21",2,2,0,0),("8:27",1,1,0,0),("8:37",2,2,0,0),("8:45",2,1,0,0),("8:51",2,2,0,0),("8:54",3,1,0,0),("8:59",1,1,0,0),("9:06",2,2,0,0),("9:13",1,1,0,0),("9:16",1,1,0,0),("9:21",2,2,0,0),("9:28",1,1,0,0),("9:36",2,2,0,0),("9:41",1,1,0,0),("9:45",1,1,0,0),("9:51",2,2,0,0),("9:59",1,2,0,0),("10:05",2,1,0,0),("10:11",1,1,0,0),("10:15",1,1,0,0),("10:21",2,2,0,0),("10:24",3,1,0,0),("10:32",1,2,0,0),("10:36",2,1,0,0),("10:48",1,1,0,0),("10:58",1,1,0,0),("11:01",2,2,0,0),("11:04",3,1,0,0),("11:11",2,1,0,0),("11:22",3,1,0,0),("11:27",3,1,0,0),("11:35",2,1,0,0),("11:48",2,2,0,0),("12:00",2,2,0,0),("12:04",3,1,0,0),("12:16",2,1,0,0),("12:24",3,1,0,0),("12:30",2,1,0,0),("12:46",2,1,0,0),("12:54",3,1,0,0),("13:00",2,2,0,0),("13:16",2,1,0,0),("13:24",3,1,0,0),("13:30",2,1,0,0),("13:46",2,1,0,0),("13:54",3,1,0,0),("14:00",2,2,0,0),("14:16",2,1,0,0),("14:24",3,1,0,0),("14:30",2,1,0,0),("14:46",2,1,0,0),("14:54",3,1,0,0),("15:00",2,2,0,0),("15:16",2,1,0,0),("15:24",3,1,0,0),("15:30",2,2,0,0),("15:46",2,1,0,0),("15:54",3,1,0,0),("16:00",2,2,0,0),("16:16",2,1,0,0),("16:24",3,1,0,0),("16:30",2,2,0,0),("16:46",2,1,0,0),("16:54",3,1,0,0),("17:00",2,2,0,0),("17:16",2,1,0,0),("17:24",3,1,0,0),("17:30",2,2,0,0),("17:46",2,1,0,0),("17:55",3,1,0,0),("18:05",2,1,0,0),("18:19",1,1,0,0),("18:23",2,2,0,0),("18:35",2,2,0,0),("18:39",3,1,0,0),("18:49",2,1,0,0),("18:54",2,2,0,0),("19:02",1,1,0,0),("19:09",2,1,0,0),("19:19",3,1,0,0),("19:23",2,2,0,0),("19:35",2,2,0,0),("19:38",3,1,0,0),("19:49",2,1,0,0),("19:54",2,2,0,0),("20:02",1,1,0,0),("20:09",2,1,0,0),("20:19",3,1,0,0),("20:23",2,2,0,0),("20:35",2,2,0,0),("20:49",2,1,0,0),("20:54",2,2,0,0),("21:02",1,1,0,0),("21:08",2,1,0,0),("21:19",3,1,0,0),("21:23",2,2,0,0),("21:29",1,1,0,0),("21:35",2,1,0,0),("21:49",2,1,0,0),("21:54",2,2,0,0),("22:01",1,1,0,0),("22:08",2,1,0,0),("22:18",3,1,0,0),("22:23",2,2,0,0),("22:37",3,1,0,0),("22:48",2,1,0,0),("22:53",2,2,0,0),("23:00",1,1,0,0),("23:08",2,1,0,0),("23:18",3,1,0,0),("23:23",2,2,0,0),("23:31",1,1,0,0),("23:36",1,1,0,0),("23:48",2,1,0,0),("23:53",2,2,0,0),("23:56",1,1,0,0),("24:01",1,1,0,0),("24:07",3,1,0,0),("24:18",2,1,0,0),("24:22",1,1,0,0),("24:29",3,1,0,0),("24:36",1,1,0,0),("24:48",1,1,0,0),("24:51",3,1,0,0),("5:06",2,1,0,1),("5:14",1,3,0,1),("5:21",1,3,0,1),("5:29",2,1,0,1),("5:32",3,1,0,1),("5:36",1,2,0,1),("5:40",3,1,0,1),("5:46",1,3,0,1),("5:50",3,1,0,1),("5:54",2,1,0,1),("5:58",1,2,0,1),("6:01",3,1,0,1),("6:04",1,3,0,1),("6:08",3,1,0,1),("6:13",1,3,0,1),("6:21",2,1,0,1),("6:24",3,1,0,1),("6:26",3,1,0,1),("6:30",1,2,0,1),("6:37",3,1,0,1),("6:40",1,3,0,1),("6:46",2,1,0,1),("6:51",3,1,0,1),("6:57",3,1,0,1),("7:00",2,1,0,1),("7:06",3,1,0,1),("7:10",1,3,0,1),("7:14",2,1,0,1),("7:18",1,2,0,1),("7:22",3,1,0,1),("7:30",1,3,0,1),("7:33",2,1,0,1),("7:41",3,1,0,1),("7:47",3,1,0,1),("7:54",3,1,0,1),("8:02",2,1,0,1),("8:07",1,2,0,1),("8:16",2,1,0,1),("8:31",2,1,0,1),("8:37",1,1,0,1),("8:47",2,1,0,1),("8:52",1,2,0,1),("9:01",2,1,0,1),("9:09",2,2,0,1),("9:22",2,1,0,1),("9:31",2,1,0,1),("9:39",2,2,0,1),("9:50",2,1,0,1),("10:01",2,1,0,1),("10:09",2,2,0,1),("10:21",2,1,0,1),("10:30",2,1,0,1),("10:36",3,1,0,1),("10:45",2,2,0,1),("11:00",2,1,0,1),("11:06",3,1,0,1),("11:15",2,2,0,1),("11:30",2,1,0,1),("11:36",3,1,0,1),("11:45",2,2,0,1),("12:00",2,1,0,1),("12:06",3,1,0,1),("12:15",2,2,0,1),("12:30",2,1,0,1),("12:36",3,1,0,1),("12:45",2,2,0,1),("13:00",2,1,0,1),("13:06",3,1,0,1),("13:15",2,2,0,1),("13:30",2,1,0,1),("13:36",3,1,0,1),("13:45",2,2,0,1),("14:00",2,1,0,1),("14:06",3,1,0,1),("14:15",2,2,0,1),("14:30",2,1,0,1),("14:36",3,1,0,1),("14:45",2,2,0,1),("15:00",2,1,0,1),("15:06",3,1,0,1),("15:17",2,2,0,1),("15:30",2,1,0,1),("15:36",3,1,0,1),("15:48",2,2,0,1),("15:59",2,1,0,1),("16:06",1,1,0,1),("16:15",2,2,0,1),("16:22",2,1,0,1),("16:28",1,1,0,1),("16:40",2,1,0,1),("16:43",1,2,0,1),("16:53",2,1,0,1),("16:58",1,1,0,1),("17:09",2,1,0,1),("17:15",1,2,0,1),("17:22",2,1,0,1),("17:27",1,1,0,1),("17:40",2,1,0,1),("17:43",1,3,0,1),("17:53",2,1,0,1),("17:57",1,1,0,1),("18:07",2,1,0,1),("18:14",1,2,0,1),("18:21",2,1,0,1),("18:24",3,1,0,1),("18:40",2,1,0,1),("18:47",3,1,0,1),("18:51",2,1,0,1),("18:57",1,1,0,1),("19:09",2,1,0,1),("19:18",3,1,0,1),("19:21",2,1,0,1),("19:26",1,3,0,1),("19:40",2,1,0,1),("19:48",3,1,0,1),("19:53",2,1,0,1),("19:58",1,1,0,1),("20:09",2,1,0,1),("20:18",1,1,0,1),("20:22",2,1,0,1),("20:39",1,2,0,1),("20:44",2,1,0,1),("20:52",2,1,0,1),("20:57",1,1,0,1),("21:09",2,1,0,1),("21:18",1,1,0,1),("21:22",2,1,0,1),("21:28",1,1,0,1),("21:41",2,1,0,1),("21:47",3,1,0,1),("21:51",2,1,0,1),("22:10",2,1,0,1),("22:15",1,1,0,1),("22:25",3,1,0,1),("22:38",1,1,0,1),("22:46",2,1,0,1),("22:53",1,1,0,1),("23:10",3,1,0,1),("23:24",3,1,0,1),("23:55",1,4,0,1);

<!-- 使えそう -->
$conn = mysqli_connect("127.0.0.1", "ryu-i-so", "rdbus", "RD_bus") or die("Access failed.");
$res = mysqli_query($conn, "SELECT * FROM train_schedule WHERE TrainKind=0 and UpOrDown = 1 ");
$ret=mysqli_fetch_array($res);
// $ret = $res->fetchAll(PDO::FETCH_COLUMN|PDO::FETCH_GROUP);
header('Content-Type: application/json; charset=utf-8');
echo $ret;

mysqli_close($conn);


SELECT train_schedule.TrainTime,trainLineKind.name,trainLineDestination.name FROM train_schedule 
LEFT JOIN trainLineKind ON train_schedule.LineKind = trainLineKind.id AND train_schedule.TrainKind = trainLineKind.trainId 
LEFT JOIN trainLineDestination ON train_schedule.LineDestination  = trainLineDestination.id AND train_schedule.TrainKind = trainLineDestination.trainId AND trainLineDestination.UpOrDown = 0
WHERE train_schedule.UpOrDown = 1 AND train_schedule.TrainKind = 0 ;

ALTER TABLE trainLineDestination ADD UpOrDown int
UPDATE trainLineDestination SET UpOrDown = 0 name = "小川町" where name = "小川町(埼玉県) " ;
INSERT INTO trainLineDestination (id,trainId,name,UpOrDown) VALUES (1,1,"池袋",1),(4,1,"川越市",1),(3,1,"新木場",1),(2,1,"元町・中華街",1);
INSERT INTO trainLineDestination (id,trainId,name,UpOrDown) VALUES (1,1,"森林公園",0),(2,1,"小川町",0);

INSERT INTO train_schedule (TrainTime,LineKind,LineDestination,TrainKind,UpOrDown) VALUES ("5:25",1,2,1,0),("5:43",1,2,1,0),("6:02",1,2,1,0),("6:17",2,2,1,0),("6:21",1,1,1,0),("6:28",1,2,1,0),("6:38",3,2,1,0),("6:48",2,2,1,0),("7:03",2,2,1,0),("7:17",2,2,1,0),("7:32",2,2,1,0),("7:41",1,1,1,0),("7:47",2,2,1,0),("7:53",1,1,1,0),("8:03",2,2,1,0),("8:18",2,2,1,0),("8:23",1,1,1,0),("8:33",2,2,1,0),("8:42",2,1,1,0),("8:48",2,2,1,0),("8:51",3,1,1,0),("8:55",1,1,1,0),("9:02",2,2,1,0),("9:09",1,1,1,0),("9:12",1,1,1,0),("9:18",2,2,1,0),("9:25",1,1,1,0),("9:32",2,2,1,0),("9:38",1,1,1,0),("9:41",1,1,1,0),("9:47",2,2,1,0),("9:55",1,2,1,0),("10:02",2,1,1,0),("10:08",1,1,1,0),("10:11",1,1,1,0),("10:17",2,2,1,0),("10:21",3,1,1,0),("10:28",1,2,1,0),("10:32",2,1,1,0),("10:45",1,1,1,0),("10:54",1,1,1,0),("10:57",2,2,1,0),("11:01",3,1,1,0),("11:07",2,1,1,0),("11:19",3,1,1,0),("11:24",3,1,1,0),("11:32",2,1,1,0),("11:45",2,2,1,0),("11:57",2,2,1,0),("12:00",3,1,1,0),("12:13",2,1,1,0),("12:21",3,1,1,0),("12:27",2,1,1,0),("12:43",2,1,1,0),("12:51",3,1,1,0),("12:57",2,2,1,0),("13:13",2,1,1,0),("13:21",3,1,1,0),("13:27",2,1,1,0),("13:43",2,1,1,0),("13:51",3,1,1,0),("13:57",2,2,1,0),("14:13",2,1,1,0),("14:21",3,1,1,0),("14:27",2,1,1,0),("14:43",2,1,1,0),("14:51",3,1,1,0),("14:57",2,2,1,0),("15:13",2,1,1,0),("15:21",3,1,1,0),("15:27",2,2,1,0),("15:43",2,1,1,0),("15:51",3,1,1,0),("15:57",2,2,1,0),("16:13",2,1,1,0),("16:21",3,1,1,0),("16:27",2,2,1,0),("16:43",2,1,1,0),("16:51",3,1,1,0),("16:57",2,2,1,0),("17:13",2,1,1,0),("17:21",3,1,1,0),("17:27",2,2,1,0),("17:43",2,1,1,0),("17:51",3,1,1,0),("18:01",2,1,1,0),("18:15",1,1,1,0),("18:19",2,2,1,0),("18:31",2,2,1,0),("18:35",3,1,1,0),("18:45",2,1,1,0),("18:51",2,2,1,0),("18:58",1,1,1,0),("19:05",2,1,1,0),("19:15",3,1,1,0),("19:19",2,2,1,0),("19:32",2,2,1,0),("19:35",3,1,1,0),("19:45",2,1,1,0),("19:51",2,2,1,0),("19:58",1,1,1,0),("20:05",2,1,1,0),("20:15",3,1,1,0),("20:20",2,2,1,0),("20:31",2,2,1,0),("20:45",2,1,1,0),("20:51",2,2,1,0),("20:58",1,1,1,0),("21:04",2,1,1,0),("21:15",3,1,1,0),("21:19",2,2,1,0),("21:26",1,1,1,0),("21:31",2,1,1,0),("21:45",2,1,1,0),("21:50",2,2,1,0),("21:58",1,1,1,0),("22:05",2,1,1,0),("22:15",3,1,1,0),("22:20",2,2,1,0),("22:34",3,1,1,0),("22:44",2,1,1,0),("22:50",2,2,1,0),("22:56",1,1,1,0),("23:04",2,1,1,0),("23:14",3,1,1,0),("23:19",2,2,1,0),("23:27",1,1,1,0),("23:33",1,1,1,0),("23:44",2,1,1,0),("23:50",2,2,1,0),("23:53",1,1,1,0),("23:57",1,1,1,0),("24:04",3,1,1,0),("24:14",2,1,1,0),("24:19",1,1,1,0),("24:26",3,1,1,0),("24:33",1,1,1,0),("24:44",1,1,1,0),("24:47",3,1,1,0),("24:56",3,1,1,0),("5:10",2,1,1,1),("5:18",1,3,1,1),("5:24",1,3,1,1),("5:33",2,1,1,1),("5:36",3,1,1,1),("5:39",1,2,1,1),("5:44",3,1,1,1),("5:50",1,3,1,1),("5:53",3,1,1,1),("5:58",2,1,1,1),("6:01",1,2,1,1),("6:04",3,1,1,1),("6:08",1,3,1,1),("6:12",3,1,1,1),("6:17",1,3,1,1),("6:25",2,1,1,1),("6:27",3,1,1,1),("6:30",3,1,1,1),("6:34",1,2,1,1),("6:41",3,1,1,1),("6:44",1,3,1,1),("6:49",2,1,1,1),("6:55",3,1,1,1),("7:00",3,1,1,1),("7:04",2,1,1,1),("7:09",3,1,1,1),("7:13",1,3,1,1),("7:18",2,1,1,1),("7:22",1,2,1,1),("7:25",3,1,1,1),("7:34",1,3,1,1),("7:37",2,1,1,1),("7:45",3,1,1,1),("7:50",3,1,1,1),("7:58",3,1,1,1),("8:05",2,1,1,1),("8:10",1,2,1,1),("8:20",2,1,1,1),("8:35",2,1,1,1),("8:40",1,1,1,1),("8:51",2,1,1,1),("8:55",1,2,1,1),("9:05",2,1,1,1),("9:13",2,2,1,1),("9:25",2,1,1,1),("9:35",2,1,1,1),("9:43",2,2,1,1),("9:54",2,1,1,1),("10:04",2,1,1,1),("10:13",2,2,1,1),("10:25",2,1,1,1),("10:34",2,1,1,1),("10:40",3,1,1,1),("10:49",2,2,1,1),("11:04",2,1,1,1),("11:10",3,1,1,1),("11:19",2,2,1,1),("11:34",2,1,1,1),("11:40",3,1,1,1),("11:49",2,2,1,1),("12:04",2,1,1,1),("12:10",3,1,1,1),("12:19",2,2,1,1),("12:34",2,1,1,1),("12:40",3,1,1,1),("12:49",2,2,1,1),("13:04",2,1,1,1),("13:10",3,1,1,1),("13:19",2,2,1,1),("13:34",2,1,1,1),("13:40",3,1,1,1),("13:49",2,2,1,1),("14:04",2,1,1,1),("14:10",3,1,1,1),("14:19",2,2,1,1),("14:34",2,1,1,1),("14:40",3,1,1,1),("14:49",2,2,1,1),("15:04",2,1,1,1),("15:10",3,1,1,1),("15:20",2,2,1,1),("15:34",2,1,1,1),("15:40",3,1,1,1),("15:51",2,2,1,1),("16:03",2,1,1,1),("16:10",1,1,1,1),("16:18",2,2,1,1),("16:25",2,1,1,1),("16:32",1,1,1,1),("16:43",2,1,1,1),("16:47",1,2,1,1),("16:56",2,1,1,1),("17:01",1,1,1,1),("17:12",2,1,1,1),("17:18",1,2,1,1),("17:25",2,1,1,1),("17:31",1,1,1,1),("17:43",2,1,1,1),("17:47",1,3,1,1),("17:56",2,1,1,1),("18:01",1,1,1,1),("18:10",2,1,1,1),("18:18",1,2,1,1),("18:24",2,1,1,1),("18:28",3,1,1,1),("18:43",2,1,1,1),("18:51",3,1,1,1),("18:54",2,1,1,1),("19:00",1,1,1,1),("19:12",2,1,1,1),("19:21",3,1,1,1),("19:25",2,1,1,1),("19:30",1,3,1,1),("19:43",2,1,1,1),("19:51",3,1,1,1),("19:56",2,1,1,1),("20:01",1,1,1,1),("20:12",2,1,1,1),("20:22",1,1,1,1),("20:26",2,1,1,1),("20:42",1,2,1,1),("20:48",2,1,1,1),("20:55",2,1,1,1),("21:01",1,1,1,1),("21:12",2,1,1,1),("21:22",1,1,1,1),("21:26",2,1,1,1),("21:32",1,1,1,1),("21:45",2,1,1,1),("21:50",3,1,1,1),("21:55",2,1,1,1),("22:13",2,1,1,1),("22:18",1,1,1,1),("22:29",3,1,1,1),("22:41",1,1,1,1),("22:49",2,1,1,1),("22:57",1,1,1,1),("23:14",3,1,1,1),("23:28",3,1,1,1),("23:59",1,4,1,1);